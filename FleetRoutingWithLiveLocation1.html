<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="initial-scale=1.0, width=device-width" />

    <!-- Here Map API's -->
    <script type="text/javascript" src="https://js.api.here.com/v3/3.0/mapsjs-core.js"></script>
    <script type="text/javascript" src="https://js.api.here.com/v3/3.0/mapsjs-service.js"></script>
    <script type="text/javascript" src="https://js.api.here.com/v3/3.0/mapsjs-ui.js"></script>
    <script type="text/javascript" src="https://js.api.here.com/v3/3.0/mapsjs-mapevents.js"></script>



    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
    <!-- Google Fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">
    <!-- Bootstrap core CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- Material Design Bootstrap -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" rel="stylesheet">
    
    <!-- JQuery -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- Bootstrap tooltips -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.4/umd/popper.min.js"></script>
    <!-- Bootstrap core JavaScript -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/js/bootstrap.min.js"></script>
    <!-- MDB core JavaScript -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js"></script>

    <link rel="stylesheet" type="text/css" href="https://js.api.here.com/v3/3.0/mapsjs-ui.css?dp-version=1549984893" />
    <link rel="stylesheet" type="text/css" href="https://www.dropbox.com/s/ou3rdncy34wow3o/styles.css"/>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">



<style type="text/css">

      .directions li span.arrow {
        display:inline-block;
        min-width:28px;
        min-height:28px;
        background-position:0px;
        background-image: url("../img/arrows.png");
        position:relative;
        top:8px;
      }
      .directions li span.depart  {
        background-position:-28px;
      }
      .directions li span.rightUTurn  {
        background-position:-56px;
      }
      .directions li span.leftUTurn  {
        background-position:-84px;
        background-position:-84px;
      }
      .directions li span.rightFork  {
        background-position:-112px;
      }
      .directions li span.leftFork  {
        background-position:-140px;
      }
      .directions li span.rightMerge  {
        background-position:-112px;
      }
      .directions li span.leftMerge  {
        background-position:-140px;
      }
      .directions li span.slightRightTurn  {
        background-position:-168px;
      }
      .directions li span.slightLeftTurn{
        background-position:-196px;
      }
      .directions li span.rightTurn  {
        background-position:-224px;
      }
      .directions li span.leftTurn{
        background-position:-252px;
      }
      .directions li span.sharpRightTurn  {
        background-position:-280px;
      }
      .directions li span.sharpLeftTurn{
        background-position:-308px;
      }
      .directions li span.rightRoundaboutExit1 {
        background-position:-616px;
      }
      .directions li span.rightRoundaboutExit2 {
        background-position:-644px;
      }

      .directions li span.rightRoundaboutExit3 {
        background-position:-672px;
      }

      .directions li span.rightRoundaboutExit4 {
        background-position:-700px;
      }

      .directions li span.rightRoundaboutPass {
        background-position:-700px;
      }

      .directions li span.rightRoundaboutExit5 {
        background-position:-728px;
      }
      .directions li span.rightRoundaboutExit6 {
        background-position:-756px;
      }
      .directions li span.rightRoundaboutExit7 {
        background-position:-784px;
      }
      .directions li span.rightRoundaboutExit8 {
        background-position:-812px;
      }
      .directions li span.rightRoundaboutExit9 {
        background-position:-840px;
      }
      .directions li span.rightRoundaboutExit10 {
        background-position:-868px;
      }
      .directions li span.rightRoundaboutExit11 {
        background-position:896px;
      }
      .directions li span.rightRoundaboutExit12 {
        background-position:924px;
      }
      .directions li span.leftRoundaboutExit1  {
        background-position:-952px;
      }
      .directions li span.leftRoundaboutExit2  {
        background-position:-980px;
      }
      .directions li span.leftRoundaboutExit3  {
        background-position:-1008px;
      }
      .directions li span.leftRoundaboutExit4  {
        background-position:-1036px;
      }
      .directions li span.leftRoundaboutPass {
        background-position:1036px;
      }
      .directions li span.leftRoundaboutExit5  {
        background-position:-1064px;
      }
      .directions li span.leftRoundaboutExit6  {
        background-position:-1092px;
      }
      .directions li span.leftRoundaboutExit7  {
        background-position:-1120px;
      }
      .directions li span.leftRoundaboutExit8  {
        background-position:-1148px;
      }
      .directions li span.leftRoundaboutExit9  {
        background-position:-1176px;
      }
      .directions li span.leftRoundaboutExit10  {
        background-position:-1204px;
      }
      .directions li span.leftRoundaboutExit11  {
        background-position:-1232px;
      }
      .directions li span.leftRoundaboutExit12  {
        background-position:-1260px;
      }
      .directions li span.arrive  {
        background-position:-1288px;
      }
      .directions li span.leftRamp  {
        background-position:-392px;
      }
      .directions li span.rightRamp  {
        background-position:-420px;
      }
      .directions li span.leftExit  {
        background-position:-448px;
      }
      .directions li span.rightExit  {
        background-position:-476px;
      }

      .directions li span.ferry  {
        background-position:-1316px;
</style>

</head>

<body style="background-color: #D3D3D3">

  <div class="container-fluid" style="padding-right: 0; padding-left: 0;">

        <nav class="navbar navbar-expand-lg navbar-dark primary-color">

            <a class="navbar-brand" href="#"><b>Code@HERE</b></a>

          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
          </button>

        <div class="collapse navbar-collapse" id="navbarText" align="center">

        <ul class="navbar-nav mr-auto">

          <li class="nav-item"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </li>
          
          <li class="nav-item"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </li>
          
          <li class="nav-item"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </li>
          
          <li class="nav-item"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </li>
          
          <li class="nav-item"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </li>
          
          <li class="nav-item"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </li>
          
          <li class="nav-item"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </li>
          
          <li class="nav-item"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </li>
          
          <li class="nav-item"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </li>
          
          <li class="nav-item"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </li>
        
          <li class="nav-item active"> <a class="nav-link" href="#"><b>HERE Virtual Webinar 2020</b></a> </li>

        </ul>  
        
        <span>

          <img src="h2.png" height="40" class="d-inline-block align-top" >
  
        </span>

        </div>

      </nav> <!-- end of nav bar -->

      &nbsp;


      <div class="container">

        <div class="row">


          <div class="col-sm-9" style="width: 80vw;">
            
            <div id="map" class="z-depth-1-half map-container-section" style="width: 48vw; height: 90vh; align-self : Left;" >   </div>

          </div>

          <div class="col-sm-3">

                        <div>
                            <label><i class="fa fa-globe" aria-hidden="true"></i> Enter your Destination : </label>
                        </div>

                        <div align="left">
                            <input class="form-control" id="to" type="text" name="to" value="" size="30" />
                        </div>
                        <br>

                        <div>
                            <button class="btn btn-light-blue" onclick="calculateRouteFromAtoB()">Search</button>
                        </div>       
          </div>


        </div>

        &nbsp;

           <div class="row">

              <div class="col">

                <div class="card">

                    <div class="card-body">
                 
                        <div id="panel"></div>

                    </div>

                </div>

               </div> 

           </div> 

      </div> <!-- end of middle panel --> 

         &nbsp;
        

            <div>
                     <!-- Footer -->
                <footer class="page-footer font-small primary-color darken-3">

                  <!-- Footer Elements -->
                  <div class="container">

                  <!-- Grid row-->
                  <div class="row">

                    <!-- Grid column -->
                    <div class="col-md-12 py-5">
                    <div class="mb-5 flex-center">

                      <!-- Facebook -->
                      <a class="fb-ic" href="https://www.facebook.com/here/">
                      <i class="fab fa-facebook-f fa-lg white-text mr-md-5 mr-3 fa-2x"> </i>
                      </a>
                      <!-- Twitter -->
                      <a class="tw-ic" href="https://twitter.com/here?lang=en">
                      <i class="fab fa-twitter fa-lg white-text mr-md-5 mr-3 fa-2x"> </i>
                      </a>
                      <!-- Github -->
                      <a class="gplus-ic" href="https://github.com/heremaps">
                      <i class="fab fa-github fa-lg white-text mr-md-5 mr-3 fa-2x"></i>
                    
                      </a>
                      <!--Linkedin -->
                      <a class="li-ic" href="https://www.linkedin.com/company/here">
                      <i class="fab fa-linkedin-in fa-lg white-text mr-md-5 mr-3 fa-2x"> </i>
                      </a>
                      <!--Instagram-->
                      <a class="ins-ic" href="https://www.instagram.com/here/?hl=en">
                      <i class="fab fa-instagram fa-lg white-text mr-md-5 mr-3 fa-2x"> </i>
                      </a>
                      <!--Youtube-->
                      <a class="pin-ic" href="https://www.youtube.com/user/heremaps">
                      <i class="fab fa-youtube fa-lg white-text mr-md-5 mr-3 fa-2x"></i>
                      </a>
                      <!--Twitch-->
                      <a class="pin-ic" href="https://m.twitch.tv/heredev/profile">
                      <i class="fab fa-twitch fa-lg white-text fa-2x"></i>
                      </a>
                      
                    </div>
                    </div>
                    <!-- Grid column -->

                  </div>
                  <!-- Grid row-->

                  </div>
                  <!-- Footer Elements -->

                  <!-- Copyright -->
                  <div class="footer-copyright text-center py-3">© 2020 Copyright:
                  <a href="https://www.here.com/"> here.com</a>
                  </div>
                  <!-- Copyright -->

                </footer>
                <!-- Footer -->
            </div>

        </div>


<script  type="text/javascript" charset="UTF-8" >
    

      /**
       * Calculates and displays a car route from the Brandenburg Gate in the centre of Berlin
       * to Friedrichstraße Railway Station.
       *
       * A full list of available request parameters can be found in the Routing API documentation.
       * see:  http://developer.here.com/rest-apis/documentation/routing/topics/resource-calculate-route.html
       *
       * @param   {H.service.Platform} platform    A stub class to access HERE services
       */




      function calculateRouteFromAtoB () {
      var from = ""; 
      var to = "";
      var platform = new H.service.Platform({ 
      app_id: 'Your_App_ID', 
      app_code: 'Your_App_Code', 
      useHTTPS: true 
      });
      const geoCoder = platform.getGeocodingService();
      geocode();
      }

      function getLiveLocation(){
      		//check if browser support location
              if(navigator.geolocation){
                  console.log("Location support");
                  navigator.geolocation.getCurrentPosition(position=>{
                      map.setCenter({
                          lat:position.coords.latitude, 
                          lng:position.coords.longitude
                      })
                      //add marker to current location
      				const geoCoder1 = platform.getGeocodingService();
                      var icon = new H.map.Icon('t2.png'); 
                      var myMarker = new H.map.Marker({lat:position.coords.latitude, lng:position.coords.longitude}, {icon:icon});
                      map.addObject(myMarker);
                      geoCoder1.reverseGeocode({
                          mode:"retrieveAddress",
                          maxresults:1,
                          prox:position.coords.latitude+", "+position.coords.longitude
                      },
                      success=>{
                          console.log(success.Response.View[0].Result[0].Location.DisplayPosition);
                          var lat = success.Response.View[0].Result[0].Location.DisplayPosition.Latitude;
                          var lng = success.Response.View[0].Result[0].Location.DisplayPosition.Longitude;
      					from = lat+","+lng;
      					console.log(from+" "+to);
      					var router = platform.getRoutingService(),
      					routeRequestParams = {
      					  mode: 'fastest;car',
      					  representation: 'display',
      					  routeattributes : 'waypoints,summary,shape,legs',
      					  maneuverattributes: 'direction,action',
      					  waypoint0: from, // variable from
      					  waypoint1: to, // variable to
      					};
      				  router.calculateRoute(
      					routeRequestParams,
      					onSuccess,
      					onError
      				  );
                          
                      },
                      error => {
                          console.log(error);
                      }
                      )
                  })
              }
      }
      /**
       * This function will be called once the Routing REST API provides a response
       * @param  {Object} result          A JSONP object representing the calculated route
       *
       * see: http://developer.here.com/rest-apis/documentation/routing/topics/resource-type-calculate-route.html
       */
      function onSuccess(result) {
        var route = result.response.route[0];
       /*
        * The styling of the route response on the map is entirely under the developer's control.
        * A representitive styling can be found the full JS + HTML code of this example
        * in the functions below:
        */
        addRouteShapeToMap(route);
        addManueversToMap(route);

        addWaypointsToPanel(route.waypoint);
        addManueversToPanel(route);
        addSummaryToPanel(route.summary);
        // ... etc.
      }

      function geocode() {
      var location = document.getElementById("to").value;
      var platform = new H.service.Platform({ 
      app_id: 'GWjEsUICSmGLw32hjpAB', 
      app_code: 'etSBXhbNVC6s3RnG_1yDtw', 
      useHTTPS: true 
      });
        	var geocoder = platform.getGeocodingService(),
          geocodingParameters = {
            searchText: location, // variable location
            jsonattributes : 1
          };
        geocoder.geocode(
          geocodingParameters,
          onSuccess1,
          onError
        );
      }

      function onSuccess1(result) {
        var locations = result.response.view[0].result;
        console.log(locations);
        var lat = locations[0].location.displayPosition.latitude;
          var  lng= locations[0].location.displayPosition.longitude;
        to = lat+","+lng;
        console.log("to  11  "+lat+","+lng);
        
        getLiveLocation();
       
      }

      /**
       * This function will be called if a communication error occurs during the JSON-P request
       * @param  {Object} error  The error message received.
       */
      function onError(error) {
        alert('Ooops!');
      }




      /**
       * Boilerplate map initialization code starts below:
       */

      // set up containers for the map  + panel
      var mapContainer = document.getElementById('map'),
        routeInstructionsContainer = document.getElementById('panel');

      //Step 1: initialize communication with the platform
      var platform = new H.service.Platform({
        app_id: 'GWjEsUICSmGLw32hjpAB',
        app_code: 'etSBXhbNVC6s3RnG_1yDtw',
        useHTTPS: true
      });
      var pixelRatio = window.devicePixelRatio || 1;
      var defaultLayers = platform.createDefaultLayers({
        tileSize: pixelRatio === 1 ? 256 : 512,
        ppi: pixelRatio === 1 ? undefined : 320
      });

      //Step 2: initialize a map - this map is centered over Berlin
      var map = new H.Map(mapContainer,
        defaultLayers.normal.map,{
        center: {lat:52.5160, lng:13.3779},
        zoom: 13,
        pixelRatio: pixelRatio
      });



      //Step 3: make the map interactive
      // MapEvents enables the event system
      // Behavior implements default interactions for pan/zoom (also on mobile touch environments)
      var behavior = new H.mapevents.Behavior(new H.mapevents.MapEvents(map));

      // Create the default UI components
      var ui = H.ui.UI.createDefault(map, defaultLayers);


      // Hold a reference to any infobubble opened
      var bubble;

      /**
       * Opens/Closes a infobubble
       * @param  {H.geo.Point} position     The location on the map.
       * @param  {String} text              The contents of the infobubble.
       */
      function openBubble(position, text){
       if(!bubble){
          bubble =  new H.ui.InfoBubble(
            position,
            // The FO property holds the province name.
            {content: text});
          ui.addBubble(bubble);
        } else {
          bubble.setPosition(position);
          bubble.setContent(text);
          bubble.open();
        }
      }


      /**
       * Creates a H.map.Polyline from the shape of the route and adds it to the map.
       * @param {Object} route A route as received from the H.service.RoutingService
       */
      function addRouteShapeToMap(route){
        var lineString = new H.geo.LineString(),
          routeShape = route.shape,
          polyline;

        routeShape.forEach(function(point) {
          var parts = point.split(',');
          lineString.pushLatLngAlt(parts[0], parts[1]);
        });

        polyline = new H.map.Polyline(lineString, {
          style: {
            lineWidth: 4,
            strokeColor: 'rgba(0, 128, 255, 0.7)'
          }
        });
        // Add the polyline to the map
        map.addObject(polyline);
        // And zoom to its bounding rectangle
        map.setViewBounds(polyline.getBounds(), true);
      }


      /**
       * Creates a series of H.map.Marker points from the route and adds them to the map.
       * @param {Object} route  A route as received from the H.service.RoutingService
       */
      function addManueversToMap(route){
        var svgMarkup = '<svg width="18" height="18" ' +
          'xmlns="http://www.w3.org/2000/svg">' +
          '<circle cx="8" cy="8" r="8" ' +
            'fill="#1b468d" stroke="white" stroke-width="1"  />' +
          '</svg>',
          dotIcon = new H.map.Icon(svgMarkup, {anchor: {x:8, y:8}}),
          group = new  H.map.Group(),
          i,
          j;

        // Add a marker for each maneuver
        for (i = 0;  i < route.leg.length; i += 1) {
          for (j = 0;  j < route.leg[i].maneuver.length; j += 1) {
            // Get the next maneuver.
            maneuver = route.leg[i].maneuver[j];
            // Add a marker to the maneuvers group
            var marker =  new H.map.Marker({
              lat: maneuver.position.latitude,
              lng: maneuver.position.longitude} ,
              {icon: dotIcon});
            marker.instruction = maneuver.instruction;
            group.addObject(marker);
          }
        }

        group.addEventListener('tap', function (evt) {
          map.setCenter(evt.target.getPosition());
          openBubble(
             evt.target.getPosition(), evt.target.instruction);
        }, false);

        // Add the maneuvers group to the map
        map.addObject(group);
      }


      /**
       * Creates a series of H.map.Marker points from the route and adds them to the map.
       * @param {Object} route  A route as received from the H.service.RoutingService
       */
      function addWaypointsToPanel(waypoints){



        var nodeH3 = document.createElement('h3'),
          waypointLabels = [],
          i;


         for (i = 0;  i < waypoints.length; i += 1) {
          waypointLabels.push(waypoints[i].label)
         }

         nodeH3.textContent = waypointLabels.join(' - ');

        routeInstructionsContainer.innerHTML = '';
        routeInstructionsContainer.appendChild(nodeH3);
      }

      /**
       * Creates a series of H.map.Marker points from the route and adds them to the map.
       * @param {Object} route  A route as received from the H.service.RoutingService
       */
      function addSummaryToPanel(summary){
        var summaryDiv = document.createElement('div'),
         content = '';
         content += '<b>Total distance</b>: ' + summary.distance  + 'm. <br/>';
         content += '<b>Travel Time</b>: ' + summary.travelTime.toMMSS() + ' (in current traffic)';


        summaryDiv.style.fontSize = 'small';
        summaryDiv.style.marginLeft ='5%';
        summaryDiv.style.marginRight ='5%';
        summaryDiv.innerHTML = content;
        routeInstructionsContainer.appendChild(summaryDiv);
      }

      /**
       * Creates a series of H.map.Marker points from the route and adds them to the map.
       * @param {Object} route  A route as received from the H.service.RoutingService
       */
      function addManueversToPanel(route){



        var nodeOL = document.createElement('ol'),
          i,
          j;

        nodeOL.style.fontSize = 'small';
        nodeOL.style.marginLeft ='5%';
        nodeOL.style.marginRight ='5%';
        nodeOL.className = 'directions';

           // Add a marker for each maneuver
        for (i = 0;  i < route.leg.length; i += 1) {
          for (j = 0;  j < route.leg[i].maneuver.length; j += 1) {
            // Get the next maneuver.
            maneuver = route.leg[i].maneuver[j];

            var li = document.createElement('li'),
              spanArrow = document.createElement('span'),
              spanInstruction = document.createElement('span');

            spanArrow.className = 'arrow '  + maneuver.action;
            spanInstruction.innerHTML = maneuver.instruction;
            li.appendChild(spanArrow);
            li.appendChild(spanInstruction);

            nodeOL.appendChild(li);
          }
        }

        routeInstructionsContainer.appendChild(nodeOL);
      }


      Number.prototype.toMMSS = function () {
        return  Math.floor(this / 60)  +' minutes '+ (this % 60)  + ' seconds.';
      }

      // Now use the map as required...
      calculateRouteFromAtoB (platform);
  </script>

</body>
</html>
